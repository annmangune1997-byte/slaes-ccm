<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Selfâ€‘Delivery vs Online Web â€“ Unified Report (Monthly Data)</title>
<style>
  body { font-family: Inter, Arial, sans-serif; background:#f5f7fb; margin:0; padding:20px; color:#0f1724}
  h1{margin:0 0 18px}
  .wrap{max-width:1200px;margin:0 auto}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
  .card{background:#fff;padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.06)}
  .kpi{grid-column:span 3;border-left:6px solid #4f46e5}
  .full{grid-column:span 12}
  table{width:100%;border-collapse:collapse;font-size:13px}
  th,td{padding:8px;border-bottom:1px solid #e6edf3;text-align:left}
  th{background:#f1f5f9}
  .muted{color:#64748b;font-size:13px}
  .controls{display:flex;gap:8px;align-items:center}
  select,button{padding:8px 10px;border-radius:8px;border:1px solid #cbd5e1;background:white}
  canvas{width:100%!important;height:320px!important}
  @media (max-width:900px){.kpi{grid-column:span 6}.full{grid-column:span 12}}
</style>
</head>
<body>
<div class="wrap">
  <h1>ðŸ“Š Selfâ€‘Delivery vs Online Web â€” Monthly Unified Report (2024 â†’ 2025)</h1>

  <div class="controls" style="margin-bottom:12px">
    <label class="muted">Branch</label>
    <select id="branchSelect"></select>
    <label class="muted">Channel</label>
    <select id="channelSelect"><option value="all">All</option><option>Self Delivery</option><option>Online Wab</option></select>
    <label class="muted">Metric</label>
    <select id="metricSelect"><option value="sales">Sales</option><option value="orders">Orders</option></select>
    <button id="exportCsv">Export CSV</button>
  </div>

  <div class="grid" style="margin-bottom:12px">
    <div class="card kpi"><div class="muted">Total Sales 2024</div><div id="tot24" style="font-weight:700;font-size:18px"></div></div>
    <div class="card kpi"><div class="muted">Total Sales 2025</div><div id="tot25" style="font-weight:700;font-size:18px"></div></div>
    <div class="card kpi"><div class="muted">Total Orders 2024</div><div id="ord24" style="font-weight:700;font-size:18px"></div></div>
    <div class="card kpi"><div class="muted">Total Orders 2025</div><div id="ord25" style="font-weight:700;font-size:18px"></div></div>

    <div class="card full"><canvas id="trendChart"></canvas></div>
    <div class="card full"><canvas id="stackChart"></canvas></div>
    <div class="card full"><h3 style="margin-top:0">Branch Ã— Channel Monthly Table</h3><div style="overflow:auto"><table id="dataTable"><thead></thead><tbody></tbody></table></div></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script>
// ======= Full monthly rows as objects (converted from user's data) =======
const DATA_ROWS = [
// Hamdan St â€” Self Delivery
{m:1,month:'Jan',branch:'Hamdan St',channel:'Self Delivery',s24:130332,s25:119300,o24:2797,o25:2757},
{m:2,month:'Feb',branch:'Hamdan St',channel:'Self Delivery',s24:119033,s25:111546,o24:2797,o25:2460},
{m:3,month:'Mar',branch:'Hamdan St',channel:'Self Delivery',s24:112730,s25:87783,o24:2474,o25:1877},
{m:4,month:'Apr',branch:'Hamdan St',channel:'Self Delivery',s24:134005,s25:106625,o24:2815,o25:2363},
{m:5,month:'May',branch:'Hamdan St',channel:'Self Delivery',s24:142948,s25:117066,o24:3066,o25:2515},
{m:6,month:'Jun',branch:'Hamdan St',channel:'Self Delivery',s24:153855,s25:106229,o24:3261,o25:2318},
{m:7,month:'Jul',branch:'Hamdan St',channel:'Self Delivery',s24:140646,s25:109205,o24:3236,o25:2557},
{m:8,month:'Aug',branch:'Hamdan St',channel:'Self Delivery',s24:146010,s25:103184,o24:3267,o25:2247},
{m:9,month:'Sep',branch:'Hamdan St',channel:'Self Delivery',s24:124891,s25:106562,o24:2658,o25:2345},
{m:10,month:'Oct',branch:'Hamdan St',channel:'Self Delivery',s24:122430,s25:103567,o24:2716,o25:2165},
{m:11,month:'Nov',branch:'Hamdan St',channel:'Self Delivery',s24:122157,s25:0,o24:2835,o25:0},
{m:12,month:'Dec',branch:'Hamdan St',channel:'Self Delivery',s24:134030,s25:0,o24:2740,o25:0},
// Hamdan St â€” Online Wab
{m:1,month:'Jan',branch:'Hamdan St',channel:'Online Wab',s24:39204,s25:25546,o24:771,o25:569},
{m:2,month:'Feb',branch:'Hamdan St',channel:'Online Wab',s24:33373,s25:28689,o24:661,o25:644},
{m:3,month:'Mar',branch:'Hamdan St',channel:'Online Wab',s24:29535,s25:23967,o24:615,o25:493},
{m:4,month:'Apr',branch:'Hamdan St',channel:'Online Wab',s24:33433,s25:35261,o24:674,o25:750},
{m:5,month:'May',branch:'Hamdan St',channel:'Online Wab',s24:35454,s25:39090,o24:733,o25:905},
{m:6,month:'Jun',branch:'Hamdan St',channel:'Online Wab',s24:40787,s25:38061,o24:825,o25:800},
{m:7,month:'Jul',branch:'Hamdan St',channel:'Online Wab',s24:39832,s25:41582,o24:876,o25:1007},
{m:8,month:'Aug',branch:'Hamdan St',channel:'Online Wab',s24:32362,s25:34835,o24:756,o25:771},
{m:9,month:'Sep',branch:'Hamdan St',channel:'Online Wab',s24:27887,s25:41146,o24:547,o25:889},
{m:10,month:'Oct',branch:'Hamdan St',channel:'Online Wab',s24:25924,s25:32395,o24:590,o25:688},
{m:11,month:'Nov',branch:'Hamdan St',channel:'Online Wab',s24:20000,s25:0,o24:450,o25:0},
{m:12,month:'Dec',branch:'Hamdan St',channel:'Online Wab',s24:24052,s25:0,o24:494,o25:0},

// Al Khalidiyah â€” Self Delivery
{m:1,month:'Jan',branch:'Al Khalidiyah',channel:'Self Delivery',s24:73203,s25:60360,o24:1444,o25:1241},
{m:2,month:'Feb',branch:'Al Khalidiyah',channel:'Self Delivery',s24:64910,s25:51718,o24:1270,o25:1054},
{m:3,month:'Mar',branch:'Al Khalidiyah',channel:'Self Delivery',s24:56006,s25:44621,o24:1114,o25:891},
{m:4,month:'Apr',branch:'Al Khalidiyah',channel:'Self Delivery',s24:63867,s25:54785,o24:1268,o25:1156},
{m:5,month:'May',branch:'Al Khalidiyah',channel:'Self Delivery',s24:71236,s25:54610,o24:1423,o25:1083},
{m:6,month:'Jun',branch:'Al Khalidiyah',channel:'Self Delivery',s24:78402,s25:56860,o24:1467,o25:1078},
{m:7,month:'Jul',branch:'Al Khalidiyah',channel:'Self Delivery',s24:72570,s25:51618,o24:1438,o25:1097},
{m:8,month:'Aug',branch:'Al Khalidiyah',channel:'Self Delivery',s24:70910,s25:51039,o24:1505,o25:1032},
{m:9,month:'Sep',branch:'Al Khalidiyah',channel:'Self Delivery',s24:61308,s25:57769,o24:1264,o25:1144},
{m:10,month:'Oct',branch:'Al Khalidiyah',channel:'Self Delivery',s24:60725,s25:61294,o24:1298,o25:1164},
{m:11,month:'Nov',branch:'Al Khalidiyah',channel:'Self Delivery',s24:60461,s25:0,o24:1217,o25:0},
{m:12,month:'Dec',branch:'Al Khalidiyah',channel:'Self Delivery',s24:85037,s25:0,o24:1225,o25:0},
// Al Khalidiyah â€” Online Wab
{m:1,month:'Jan',branch:'Al Khalidiyah',channel:'Online Wab',s24:21135,s25:13749,o24:412,o25:292},
{m:2,month:'Feb',branch:'Al Khalidiyah',channel:'Online Wab',s24:21217,s25:14662,o24:417,o25:305},
{m:3,month:'Mar',branch:'Al Khalidiyah',channel:'Online Wab',s24:16169,s25:12644,o24:321,o25:198},
{m:4,month:'Apr',branch:'Al Khalidiyah',channel:'Online Wab',s24:20903,s25:16370,o24:390,o25:312},
{m:5,month:'May',branch:'Al Khalidiyah',channel:'Online Wab',s24:19685,s25:20318,o24:366,o25:439},
{m:6,month:'Jun',branch:'Al Khalidiyah',channel:'Online Wab',s24:21759,s25:19102,o24:399,o25:377},
{m:7,month:'Jul',branch:'Al Khalidiyah',channel:'Online Wab',s24:22254,s25:17766,o24:447,o25:426},
{m:8,month:'Aug',branch:'Al Khalidiyah',channel:'Online Wab',s24:18936,s25:17361,o24:388,o25:365},
{m:9,month:'Sep',branch:'Al Khalidiyah',channel:'Online Wab',s24:14826,s25:16495,o24:281,o25:316},
{m:10,month:'Oct',branch:'Al Khalidiyah',channel:'Online Wab',s24:16403,s25:17815,o24:371,o25:354},
{m:11,month:'Nov',branch:'Al Khalidiyah',channel:'Online Wab',s24:11694,s25:0,o24:253,o25:0},
{m:12,month:'Dec',branch:'Al Khalidiyah',channel:'Online Wab',s24:12724,s25:0,o24:245,o25:0},

// Shabiya 11 â€” Self Delivery
{m:1,month:'Jan',branch:'Shabiya 11',channel:'Self Delivery',s24:53600,s25:52778,o24:1184,o25:1201},
{m:2,month:'Feb',branch:'Shabiya 11',channel:'Self Delivery',s24:56902,s25:51105,o24:1260,o25:1136},
{m:3,month:'Mar',branch:'Shabiya 11',channel:'Self Delivery',s24:50445,s25:40273,o24:1167,o25:906},
{m:4,month:'Apr',branch:'Shabiya 11',channel:'Self Delivery',s24:63642,s25:56981,o24:1434,o25:1246},
{m:5,month:'May',branch:'Shabiya 11',channel:'Self Delivery',s24:62211,s25:56703,o24:1380,o25:1187},
{m:6,month:'Jun',branch:'Shabiya 11',channel:'Self Delivery',s24:64920,s25:54611,o24:1396,o25:1114},
{m:7,month:'Jul',branch:'Shabiya 11',channel:'Self Delivery',s24:60095,s25:55160,o24:1366,o25:1177},
{m:8,month:'Aug',branch:'Shabiya 11',channel:'Self Delivery',s24:58704,s25:55336,o24:1388,o25:1162},
{m:9,month:'Sep',branch:'Shabiya 11',channel:'Self Delivery',s24:50504,s25:61290,o24:1135,o25:1269},
{m:10,month:'Oct',branch:'Shabiya 11',channel:'Self Delivery',s24:56993,s25:57956,o24:1324,o25:1225},
{m:11,month:'Nov',branch:'Shabiya 11',channel:'Self Delivery',s24:59511,s25:0,o24:1272,o25:0},
{m:12,month:'Dec',branch:'Shabiya 11',channel:'Self Delivery',s24:56257,s25:0,o24:1152,o25:0},
// Shabiya 11 â€” Online Wab
{m:1,month:'Jan',branch:'Shabiya 11',channel:'Online Wab',s24:11054,s25:7398,o24:244,o25:177},
{m:2,month:'Feb',branch:'Shabiya 11',channel:'Online Wab',s24:11743,s25:6340,o24:222,o25:143},
{m:3,month:'Mar',branch:'Shabiya 11',channel:'Online Wab',s24:8011,s25:3282,o24:179,o25:74},
{m:4,month:'Apr',branch:'Shabiya 11',channel:'Online Wab',s24:7720,s25:12005,o24:163,o25:245},
{m:5,month:'May',branch:'Shabiya 11',channel:'Online Wab',s24:10015,s25:13045,o24:204,o25:308},
{m:6,month:'Jun',branch:'Shabiya 11',channel:'Online Wab',s24:11933,s25:15350,o24:238,o25:306},
{m:7,month:'Jul',branch:'Shabiya 11',channel:'Online Wab',s24:9793,s25:16910,o24:223,o25:404},
{m:8,month:'Aug',branch:'Shabiya 11',channel:'Online Wab',s24:11299,s25:12568,o24:237,o25:260},
{m:9,month:'Sep',branch:'Shabiya 11',channel:'Online Wab',s24:8747,s25:10420,o24:179,o25:216},
{m:10,month:'Oct',branch:'Shabiya 11',channel:'Online Wab',s24:10253,s25:11708,o24:257,o25:254},
{m:11,month:'Nov',branch:'Shabiya 11',channel:'Online Wab',s24:10046,s25:0,o24:219,o25:0},
{m:12,month:'Dec',branch:'Shabiya 11',channel:'Online Wab',s24:7951,s25:0,o24:151,o25:0},

// Muroor â€” Self Delivery
{m:1,month:'Jan',branch:'Muroor',channel:'Self Delivery',s24:56696,s25:59749,o24:1140,o25:1255},
{m:2,month:'Feb',branch:'Muroor',channel:'Self Delivery',s24:54156,s25:58438,o24:1078,o25:1199},
{m:3,month:'Mar',branch:'Muroor',channel:'Self Delivery',s24:45652,s25:41808,o24:899,o25:817},
{m:4,month:'Apr',branch:'Muroor',channel:'Self Delivery',s24:59978,s25:56795,o24:1209,o25:1211},
{m:5,month:'May',branch:'Muroor',channel:'Self Delivery',s24:61958,s25:54302,o24:1294,o25:1094},
{m:6,month:'Jun',branch:'Muroor',channel:'Self Delivery',s24:71109,s25:56046,o24:1341,o25:1076},
{m:7,month:'Jul',branch:'Muroor',channel:'Self Delivery',s24:63143,s25:53001,o24:1360,o25:1114},
{m:8,month:'Aug',branch:'Muroor',channel:'Self Delivery',s24:64842,s25:44361,o24:1386,o25:912},
{m:9,month:'Sep',branch:'Muroor',channel:'Self Delivery',s24:61113,s25:51018,o24:1295,o25:973},
{m:10,month:'Oct',branch:'Muroor',channel:'Self Delivery',s24:65561,s25:50495,o24:1384,o25:973},
{m:11,month:'Nov',branch:'Muroor',channel:'Self Delivery',s24:62004,s25:0,o24:1380,o25:0},
{m:12,month:'Dec',branch:'Muroor',channel:'Self Delivery',s24:63780,s25:0,o24:1231,o25:0},
// Muroor â€” Online Wab
{m:1,month:'Jan',branch:'Muroor',channel:'Online Wab',s24:8231,s25:3352,o24:154,o25:72},
{m:2,month:'Feb',branch:'Muroor',channel:'Online Wab',s24:11050,s25:3939,o24:199,o25:74},
{m:3,month:'Mar',branch:'Muroor',channel:'Online Wab',s24:7874,s25:3831,o24:143,o25:67},
{m:4,month:'Apr',branch:'Muroor',channel:'Online Wab',s24:8167,s25:6103,o24:140,o25:113},
{m:5,month:'May',branch:'Muroor',channel:'Online Wab',s24:9704,s25:6438,o24:174,o25:131},
{m:6,month:'Jun',branch:'Muroor',channel:'Online Wab',s24:10966,s25:6600,o24:191,o25:120},
{m:7,month:'Jul',branch:'Muroor',channel:'Online Wab',s24:9358,s25:6127,o24:176,o25:125},
{m:8,month:'Aug',branch:'Muroor',channel:'Online Wab',s24:8392,s25:5884,o24:157,o25:116},
{m:9,month:'Sep',branch:'Muroor',channel:'Online Wab',s24:7504,s25:6668,o24:146,o25:119},
{m:10,month:'Oct',branch:'Muroor',channel:'Online Wab',s24:5777,s25:5435,o24:146,o25:89},
{m:11,month:'Nov',branch:'Muroor',channel:'Online Wab',s24:6152,s25:0,o24:116,o25:0},
{m:12,month:'Dec',branch:'Muroor',channel:'Online Wab',s24:8064,s25:0,o24:119,o25:0},

// Electra â€” all zeros (12 months each channel)
{m:1,month:'Jan',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:2,month:'Feb',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:3,month:'Mar',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:4,month:'Apr',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:5,month:'May',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:6,month:'Jun',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:7,month:'Jul',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:8,month:'Aug',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:9,month:'Sep',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:10,month:'Oct',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:11,month:'Nov',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:12,month:'Dec',branch:'Electra',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:1,month:'Jan',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:2,month:'Feb',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:3,month:'Mar',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:4,month:'Apr',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:5,month:'May',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:6,month:'Jun',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:7,month:'Jul',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:8,month:'Aug',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:9,month:'Sep',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:10,month:'Oct',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:11,month:'Nov',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:12,month:'Dec',branch:'Electra',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},

// Al Barsha â€” Self Delivery
{m:1,month:'Jan',branch:'Al Barsha',channel:'Self Delivery',s24:30120,s25:55752,o24:802,o25:1726},
{m:2,month:'Feb',branch:'Al Barsha',channel:'Self Delivery',s24:33556,s25:51699,o24:928,o25:1527},
{m:3,month:'Mar',branch:'Al Barsha',channel:'Self Delivery',s24:30722,s25:42075,o24:928,o25:1427},
{m:4,month:'Apr',branch:'Al Barsha',channel:'Self Delivery',s24:40737,s25:61422,o24:1173,o25:1816},
{m:5,month:'May',branch:'Al Barsha',channel:'Self Delivery',s24:50460,s25:36988,o24:1487,o25:881},
{m:6,month:'Jun',branch:'Al Barsha',channel:'Self Delivery',s24:48778,s25:41436,o24:1488,o25:891},
{m:7,month:'Jul',branch:'Al Barsha',channel:'Self Delivery',s24:56252,s25:44627,o24:1740,o25:1007},
{m:8,month:'Aug',branch:'Al Barsha',channel:'Self Delivery',s24:54008,s25:49296,o24:1813,o25:901},
{m:9,month:'Sep',branch:'Al Barsha',channel:'Self Delivery',s24:54921,s25:43361,o24:1749,o25:879},
{m:10,month:'Oct',branch:'Al Barsha',channel:'Self Delivery',s24:55783,s25:44819,o24:1894,o25:850},
{m:11,month:'Nov',branch:'Al Barsha',channel:'Self Delivery',s24:44274,s25:0,o24:1595,o25:0},
{m:12,month:'Dec',branch:'Al Barsha',channel:'Self Delivery',s24:48203,s25:0,o24:1424,o25:0},
// Al Barsha â€” Online Wab
{m:1,month:'Jan',branch:'Al Barsha',channel:'Online Wab',s24:19348,s25:8325,o24:365,o25:156},
{m:2,month:'Feb',branch:'Al Barsha',channel:'Online Wab',s24:16597,s25:8977,o24:304,o25:178},
{m:3,month:'Mar',branch:'Al Barsha',channel:'Online Wab',s24:14043,s25:4816,o24:243,o25:98},
{m:4,month:'Apr',branch:'Al Barsha',channel:'Online Wab',s24:12546,s25:9647,o24:221,o25:181},
{m:5,month:'May',branch:'Al Barsha',channel:'Online Wab',s24:16921,s25:9039,o24:290,o25:176},
{m:6,month:'Jun',branch:'Al Barsha',channel:'Online Wab',s24:17351,s25:7877,o24:299,o25:161},
{m:7,month:'Jul',branch:'Al Barsha',channel:'Online Wab',s24:14681,s25:8453,o24:276,o25:173},
{m:8,month:'Aug',branch:'Al Barsha',channel:'Online Wab',s24:13840,s25:7404,o24:250,o25:159},
{m:9,month:'Sep',branch:'Al Barsha',channel:'Online Wab',s24:12385,s25:8490,o24:203,o25:167},
{m:10,month:'Oct',branch:'Al Barsha',channel:'Online Wab',s24:10663,s25:7406,o24:178,o25:122},
{m:11,month:'Nov',branch:'Al Barsha',channel:'Online Wab',s24:12048,s25:0,o24:214,o25:0},
{m:12,month:'Dec',branch:'Al Barsha',channel:'Online Wab',s24:9084,s25:0,o24:171,o25:0},

// Al Satwa â€” Self Delivery
{m:1,month:'Jan',branch:'Al Satwa',channel:'Self Delivery',s24:0,s25:26849,o24:0,o25:818},
{m:2,month:'Feb',branch:'Al Satwa',channel:'Self Delivery',s24:0,s25:24349,o24:0,o25:719},
{m:3,month:'Mar',branch:'Al Satwa',channel:'Self Delivery',s24:0,s25:21934,o24:0,o25:645},
{m:4,month:'Apr',branch:'Al Satwa',channel:'Self Delivery',s24:0,s25:29154,o24:0,o25:881},
{m:5,month:'May',branch:'Al Satwa',channel:'Self Delivery',s24:22337,s25:20631,o24:555,o25:506},
{m:6,month:'Jun',branch:'Al Satwa',channel:'Self Delivery',s24:26665,s25:21005,o24:684,o25:463},
{m:7,month:'Jul',branch:'Al Satwa',channel:'Self Delivery',s24:27671,s25:24685,o24:795,o25:528},
{m:8,month:'Aug',branch:'Al Satwa',channel:'Self Delivery',s24:34732,s25:22476,o24:965,o25:492},
{m:9,month:'Sep',branch:'Al Satwa',channel:'Self Delivery',s24:27068,s25:23066,o24:799,o25:495},
{m:10,month:'Oct',branch:'Al Satwa',channel:'Self Delivery',s24:29957,s25:12773,o24:831,o25:293},
{m:11,month:'Nov',branch:'Al Satwa',channel:'Self Delivery',s24:25687,s25:0,o24:765,o25:0},
{m:12,month:'Dec',branch:'Al Satwa',channel:'Self Delivery',s24:29521,s25:0,o24:768,o25:0},
// Al Satwa â€” Online Wab
{m:1,month:'Jan',branch:'Al Satwa',channel:'Online Wab',s24:0,s25:7572,o24:0,o25:210},
{m:2,month:'Feb',branch:'Al Satwa',channel:'Online Wab',s24:0,s25:9979,o24:0,o25:240},
{m:3,month:'Mar',branch:'Al Satwa',channel:'Online Wab',s24:0,s25:5832,o24:0,o25:134},
{m:4,month:'Apr',branch:'Al Satwa',channel:'Online Wab',s24:0,s25:11509,o24:0,o25:283},
{m:5,month:'May',branch:'Al Satwa',channel:'Online Wab',s24:569,s25:13388,o24:15,o25:348},
{m:6,month:'Jun',branch:'Al Satwa',channel:'Online Wab',s24:6303,s25:13815,o24:148,o25:343},
{m:7,month:'Jul',branch:'Al Satwa',channel:'Online Wab',s24:9685,s25:18083,o24:234,o25:484},
{m:8,month:'Aug',branch:'Al Satwa',channel:'Online Wab',s24:11818,s25:14903,o24:299,o25:387},
{m:9,month:'Sep',branch:'Al Satwa',channel:'Online Wab',s24:8026,s25:15232,o24:177,o25:376},
{m:10,month:'Oct',branch:'Al Satwa',channel:'Online Wab',s24:9119,s25:11183,o24:225,o25:288},
{m:11,month:'Nov',branch:'Al Satwa',channel:'Online Wab',s24:8731,s25:0,o24:216,o25:0},
{m:12,month:'Dec',branch:'Al Satwa',channel:'Online Wab',s24:9441,s25:0,o24:216,o25:0},

// Al Rigga â€” Self Delivery
{m:1,month:'Jan',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:2,month:'Feb',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:3,month:'Mar',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:4,month:'Apr',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:5,month:'May',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:6,month:'Jun',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:7,month:'Jul',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:8,month:'Aug',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:9,month:'Sep',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:1993,o24:0,o25:45},
{m:10,month:'Oct',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:14634.9,o24:0,o25:332},
{m:11,month:'Nov',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:12,month:'Dec',branch:'Al Rigga',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
// Al Rigga â€” Online Wab
{m:1,month:'Jan',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:2,month:'Feb',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:3,month:'Mar',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:4,month:'Apr',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:5,month:'May',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:6,month:'Jun',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:7,month:'Jul',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:8,month:'Aug',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:9,month:'Sep',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:10,month:'Oct',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:2076,o24:0,o25:62},
{m:11,month:'Nov',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:12,month:'Dec',branch:'Al Rigga',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},

// Sharja â€” all zeros
{m:1,month:'Jan',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:2,month:'Feb',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:3,month:'Mar',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:4,month:'Apr',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:5,month:'May',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:6,month:'Jun',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:7,month:'Jul',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:8,month:'Aug',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:9,month:'Sep',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:10,month:'Oct',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:11,month:'Nov',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:12,month:'Dec',branch:'Sharja',channel:'Self Delivery',s24:0,s25:0,o24:0,o25:0},
{m:1,month:'Jan',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:2,month:'Feb',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:3,month:'Mar',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:4,month:'Apr',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:5,month:'May',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:6,month:'Jun',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:7,month:'Jul',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:8,month:'Aug',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:9,month:'Sep',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:10,month:'Oct',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:11,month:'Nov',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0},
{m:12,month:'Dec',branch:'Sharja',channel:'Online Wab',s24:0,s25:0,o24:0,o25:0}
];

// ======= Helper functions =======
function fmt(n){ return Number(n).toLocaleString(); }
function sum(arr, key){ return arr.reduce((s,x)=>s + (Number(x[key])||0),0); }
function unique(arr, key){ return [...new Set(arr.map(r=>r[key]))]; }

// ======= Build branch select options =======
const branches = unique(DATA_ROWS,'branch');
const branchSelect = document.getElementById('branchSelect');
branchSelect.innerHTML = '<option value="all">All Branches</option>' + branches.map(b=>`<option>${b}</option>`).join('');
branchSelect.value = 'all';

// ======= Build table =======
function buildTable(filterBranch, filterChannel){
  const table = document.getElementById('dataTable');
  const thead = `<tr><th>Month</th><th>Branch</th><th>Channel</th><th>Sales 2024</th><th>Sales 2025</th><th>Orders 2024</th><th>Orders 2025</th></tr>`;
  const rows = DATA_ROWS.filter(r=> (filterBranch==='all' || r.branch===filterBranch) && (filterChannel==='all' || r.channel===filterChannel));
  const tbody = rows.map(r=>`<tr><td>${r.month}</td><td>${r.branch}</td><td>${r.channel}</td><td>${fmt(r.s24)}</td><td>${fmt(r.s25)}</td><td>${fmt(r.o24)}</td><td>${fmt(r.o25)}</td></tr>`).join('');
  table.querySelector('thead').innerHTML = thead;
  table.querySelector('tbody').innerHTML = tbody;
}

// ======= Aggregations & KPIs =======
function updateKPIs(filterBranch, filterChannel){
  const rows = DATA_ROWS.filter(r=> (filterBranch==='all' || r.branch===filterBranch) && (filterChannel==='all' || r.channel===filterChannel));
  const totalS24 = sum(rows,'s24');
  const totalS25 = sum(rows,'s25');
  const totalO24 = sum(rows,'o24');
  const totalO25 = sum(rows,'o25');
  document.getElementById('tot24').textContent = fmt(totalS24);
  document.getElementById('tot25').textContent = fmt(totalS25);
  document.getElementById('ord24').textContent = fmt(totalO24);
  document.getElementById('ord25').textContent = fmt(totalO25);
}

// ======= Charts =======
let trendChart, stackChart;
function renderCharts(filterBranch, filterChannel, metric){
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const monthly24 = Array(12).fill(0);
  const monthly25 = Array(12).fill(0);

  DATA_ROWS.forEach(r=>{
    if((filterBranch==='all' || r.branch===filterBranch) && (filterChannel==='all' || r.channel===filterChannel)){
      const idx = r.m-1;
      if(metric==='sales'){ monthly24[idx] += Number(r.s24)||0; monthly25[idx] += Number(r.s25)||0; }
      else { monthly24[idx] += Number(r.o24)||0; monthly25[idx] += Number(r.o25)||0; }
    }
  });

  if(trendChart) trendChart.destroy();
  const ctx = document.getElementById('trendChart');
  trendChart = new Chart(ctx, {type:'line',data:{labels:months,datasets:[{label:metric+ ' 2024',data:monthly24,borderColor:'#3b82f6',tension:0.3,fill:false},{label:metric+ ' 2025',data:monthly25,borderColor:'#10b981',tension:0.3,fill:false}]},options:{responsive:true}});

  if(stackChart) stackChart.destroy();
  const ctx2 = document.getElementById('stackChart');
  const branchesList = (filterBranch==='all')? unique(DATA_ROWS,'branch'):[filterBranch];
  const labels = branchesList;
  const selfVals = labels.map(b=> sum(DATA_ROWS.filter(r=>r.branch===b && r.channel==='Self Delivery'),'s25'));
  const webVals = labels.map(b=> sum(DATA_ROWS.filter(r=>r.branch===b && r.channel==='Online Wab'),'s25'));
  stackChart = new Chart(ctx2,{type:'bar',data:{labels:labels,datasets:[{label:'Self Delivery 2025',data:selfVals,backgroundColor:'#4f46e5'},{label:'Online Web 2025',data:webVals,backgroundColor:'#06b6d4'}]},options:{responsive:true,scales:{x:{stacked:true},y:{stacked:true}}}});
}

// ======= UI interactions =======
const channelSelect = document.getElementById('channelSelect');
const metricSelect = document.getElementById('metricSelect');
function refresh(){
  const branch = branchSelect.value;
  const channel = channelSelect.value;
  const metric = metricSelect.value;
  buildTable(branch, channel);
  updateKPIs(branch, channel);
  renderCharts(branch, channel, metric);
}
branchSelect.onchange = refresh; channelSelect.onchange = refresh; metricSelect.onchange = refresh;

// initial render
refresh();

// ======= Export CSV =======
document.getElementById('exportCsv').onclick = function(){
  const rows = DATA_ROWS;
  let csv = 'Month,Branch,Channel,Sales2024,Sales2025,Orders2024,Orders2025\n';
  rows.forEach(r=> csv += `${r.month},${r.branch},${r.channel},${r.s24},${r.s25},${r.o24},${r.o25}\n`);
  const blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});
  const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='monthly_report.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
};

</script>
</body>
</html>
